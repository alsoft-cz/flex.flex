----------------------------------------------------------------------------------------------------
module public cc_xml_dumper =
-- XML dumper
----------------------------------------------------------------------------------------------------
-- honzap : 8.12.2003 : Vytvo©il
----------------------------------------------------------------------------------------------------

with
  standard,
  standard.files,           
  standard.streams,
  standard.characters,
  standard.classes,
  standard.classes.lists;

message
  -- chyba p©i v˜stupu do XML
  xml_dumper_error;

-- dop©edn‚ deklarace
class c_xml_dumper;        type p_xml_dumper        = ^class c_xml_dumper;
class c_file_xml_dumper;   type p_file_xml_dumper   = ^class c_file_xml_dumper;
class c_stream_xml_dumper; type p_stream_xml_dumper = ^class c_stream_xml_dumper;

----------------------------------------------------------------------------------------------------
class public c_xml_dumper =
-- XML dumper
-- Interface pro z pis do XML
-- Jeho implementace m–‘e prov dˆt test, zda volan  operace neporu¨¡ spr vnost v˜sledn‚ho XML
-- P©¡klad pou‘it¡:
-- 
-- Po‘adovan‚ XML:
-- 
-- <auto id="UOC 13-65">
--   <barva>modra</barva>
--   <karoserie stav="rozbita">combi</karoserie>
--   <kolo stav="ukradene"/>
-- </auto>
-- 
-- se z¡sk  sekvenc¡ vol n¡
-- 
-- go_in('auto');write_attribute('id','UOC 13-65');
--   write_text_element('barva','modra'); -- nebo go_in('barva');write_text('modra');go_out('barva');
--   go_in('karoserie');write_attribute('stav','rozbita');write_text('combi');go_out('karoserie');
--   go_in('kolo');write_attribute('stav','ukradene');go_out('kolo');
-- go_out('auto');

----------------------------------------------------------------------------------------------------

    ------------------------------------------------------------------------------------------------
    virtual abstract go_in (
        name       : in t_char32ustr);           -- jm‚no elementu
    -- Provede zano©en¡ do elementu.
    ------------------------------------------------------------------------------------------------
    virtual abstract go_out (
        name       : in t_char32ustr);           -- jm‚no elementu
    -- Provede vyno©en¡ z elementu.
    ------------------------------------------------------------------------------------------------
    virtual abstract write_attribute (
        name       : in t_char32ustr;            -- jm‚no atributu
        value      : in t_char32ustr);           -- hodnota atributu
    -- Zap¡¨e atribut name="value"
    ------------------------------------------------------------------------------------------------
    virtual abstract write_text (
        text       : in t_char32ustr);           -- zapisovan˜ text
    -- Zap¡¨e textovou hodnotu
    ------------------------------------------------------------------------------------------------
    static write_text_element (
        name       : in t_char32ustr;            -- jm‚no atributu
        text       : in t_char32ustr);           -- zapisovan˜ text
    -- Zap¡¨e <name>text</name>, zkratka za go_in(name);write_text(text);go_out(name)
    ------------------------------------------------------------------------------------------------

    end c_xml_dumper;


----------------------------------------------------------------------------------------------------
class public c_stream_xml_dumper = extend c_xml_dumper;
-- Jednoduch˜ dumper - vystavuje rozhran¡ [c_xml_dumper] a implemetuje ho jako z pis do XML souboru
-- M  pouze minimum kontrol - je mo‘n‚ s n¡m vygenerovat nespr vn‚ XML
-- Pokud chybu odhal¡, vyvol  chybu [xml_dumper_error]
----------------------------------------------------------------------------------------------------

    ------------------------------------------------------------------------------------------------
    static init_writer (
        writer     : in p_text_writer);           -- v˜stupn¡ soubor
    -- inicializace
    ------------------------------------------------------------------------------------------------

    end c_stream_xml_dumper;


----------------------------------------------------------------------------------------------------
class public c_file_xml_dumper = extend c_stream_xml_dumper;
-- Dumper do souboru
----------------------------------------------------------------------------------------------------

    ------------------------------------------------------------------------------------------------
    static init (
        file       : in t_char32ustr);           -- v˜stupn¡ soubor
    -- inicializace
    ------------------------------------------------------------------------------------------------

    end c_file_xml_dumper;

end cc_xml_dumper;

