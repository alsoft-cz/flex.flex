----------------------------------------------------------------------------------------------------
module public ci_expr =
-- P©eklada‡ Flexu.
-- Generov n¡ v˜razu.
----------------------------------------------------------------------------------------------------
-- Ondra : 22.01.2003 : Vytvo©il.
----------------------------------------------------------------------------------------------------

with
  standard,
  cx_expr,cx_expr.cx_def,
  cp_cpu.cp_32.cp_def,
  cg_gen.cg_ia32.ci_def,
  cg_gen.cg_ia32.ci_code,
  cg_gen.cg_ia32.ci_code.ci_operand,
  cc_base,
  cc_base.cc_type;

----------------------------------------------------------------------------------------------------
procedure i_gen_expr (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    expr           : in pexpnode);               -- strom
-- Generov n¡ k¢du v˜razu.
----------------------------------------------------------------------------------------------------
procedure i_gen_cond (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    expr           : in pexpnode;                -- strom
    ttarget        : in itarget;                 -- c¡l skoku p©i True
    ftarget        : in itarget);                -- c¡l skoku p©i False
-- Generov n¡ k¢du v˜razu.
-- Pokud je c¡l skoku nastaven na TGFALLTHRU, tak nesko‡¡ nikam.
----------------------------------------------------------------------------------------------------
procedure i_load_message_code (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    expr           : in pexpnode);               -- strom
-- Na‡te k¢d zpr vy do EAX.
----------------------------------------------------------------------------------------------------
procedure i_load_expr (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    context        : in out iexprcontext;        -- kontext generov n¡ v˜razu
    expr           : in pexpnode;                -- v˜raz
    vysl           : out c_operand);             -- v˜sledek
-- Vygeneruje a na‡te hodnotu podv˜razu.
----------------------------------------------------------------------------------------------------
procedure i_load_subexpr (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    subcontext     : in out iexprcontext;        -- kontext podv˜razu
    supercontext   : in out iexprcontext;        -- kontext v˜razu
    expr           : in pexpnode;                -- v˜raz
    vysl           : out c_operand);             -- v˜sledek
-- Vygeneruje a na‡te hodnotu podv˜razu.
----------------------------------------------------------------------------------------------------
procedure i_load_rtattrib (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    rta            : in rtattrib;                -- po‘adovan˜ atribut
    expr           : in pexpnode;                -- strom
    reg            : in t_logical;               -- T-p©edat v registru
    vysl           : out c_operand);             -- v˜sledek
-- Na‡te po‘adovan˜ run-time atribut dan‚ho v˜razu.
-- Je-li REG=True, p©ed  v˜sledek v registru, jinak v temporary promˆnn‚.
----------------------------------------------------------------------------------------------------
procedure i_load_subrtattrib (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    supercontext   : in out iexprcontext;        -- kontext v˜razu
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    rta            : in rtattrib;                -- po‘adovan˜ atribut
    expr           : in pexpnode;                -- strom
    reg            : in t_logical;               -- T-p©edat v registru
    vysl           : out c_operand);             -- v˜sledek
-- Na‡te po‘adovan˜ run-time atribut dan‚ho v˜razu.
-- Je-li REG=True, p©ed  v˜sledek v registru, jinak v temporary promˆnn‚.
----------------------------------------------------------------------------------------------------
procedure i_load_length (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    expr           : in pexpnode;                -- strom
    reg            : in t_logical;               -- T-p©edat v registru
    vysl           : out c_operand);             -- v˜sledek
-- Na‡te run-time atribut :length dan‚ho v˜razu.
-- Je-li REG=True, p©ed  v˜sledek v registru, jinak v temporary promˆnn‚.
-- %%X Nˆco jako z plata. Vymyslet sjednocen¡ s I_LOAD_RTATTRIB asi na b zi slou‡en¡ s I_GEN_ATTRIB.
----------------------------------------------------------------------------------------------------
procedure i_load_sublength (
    inst           : in out icodeinst;           -- instance
    info           : in out igeninfo;            -- informace o pr–bˆhu generov n¡
    supercontext   : in out iexprcontext;        -- kontext v˜razu
    curr           : in class tentity;           -- p©ekl dan˜ prvek
    expr           : in pexpnode;                -- strom
    reg            : in t_logical;               -- T-p©edat v registru
    vysl           : out c_operand);             -- v˜sledek
-- Na‡te run-time atribut :length dan‚ho v˜razu.
-- Je-li REG=True, p©ed  v˜sledek v registru, jinak v temporary promˆnn‚.
-- %%X Nˆco jako z plata. Vymyslet sjednocen¡ s I_LOAD_RTATTRIB asi na b zi slou‡en¡ s I_GEN_ATTRIB.
----------------------------------------------------------------------------------------------------

end ci_expr;
