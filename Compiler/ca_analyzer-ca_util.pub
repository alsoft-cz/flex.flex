----------------------------------------------------------------------------------------------------
module public ca_util =
-- P©eklada‡ Flexu.
-- R–zn‚ u‘ite‡n‚ procedury.                                                  
----------------------------------------------------------------------------------------------------
-- Ondra : 28.02.2002 : Vytvo©il
----------------------------------------------------------------------------------------------------

with
  cc_def,cc_def.cc_entity,
  cb_block,cb_block.cb_def,
  cx_expr,cx_expr.cx_def,
  cc_base,
  cc_base.cc_sym;

----------------------------------------------------------------------------------------------------
procedure a_prepare_info (
    binfo          : in out blinfo;              -- informace pro generov n¡ p©¡kaz–
    xinfo          : in out expinfo);            -- informace pro generov n¡ v˜raz–
-- P©iprav¡ informace pro kompil torem generovan‚ uzly.
----------------------------------------------------------------------------------------------------
procedure a_list_append (
    list           : in out bllist;              -- kam se budou p©¡kazy ukl dat      
    bl             : in pblnode);                -- za©azovan˜ p©¡kaz                 
-- Za©ad¡ p©¡kaz BL na konec seznamu p©¡kaz–.                                 
-- Je-li BL=NIL, nic se nestane.
----------------------------------------------------------------------------------------------------
procedure a_find_executing_range (
    context        : in tcontext;                -- kontext
    range_low      : out pentity_var;            -- spodn¡ mez rozsahu 
    range_high     : out pentity_var);           -- horn¡ mez rozsahu 
-- Prohled  zadan˜ kontext a pokud jsou obsa‘eny vr t¡ informace o rozsahu prov dˆn¡.
----------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------
class public c_class_hidden_field_helper = extend c_flex_class;
-- T©¡da pro pr ci s poli @TAG a @STATUS v instanci t©¡dy.
----------------------------------------------------------------------------------------------------

    ------------------------------------------------------------------------------------------------
    static set_context ( 
        context    : in tcontext);               -- kontext t©¡dy
    -- Nastav¡ kontext pro vyhled v n¡ skryt˜ch slo‘ek - context typu t©¡dy.
    ------------------------------------------------------------------------------------------------
    static a_make_set_tag (
        curr       : in tcontext;                -- kontext          
        list       : in out bllist;              -- kam se budou p©¡kazy ukl dat      
        binfo      : in blinfo;                  -- informace pro generov n¡ p©¡kaz–
        xinfo      : in expinfo;                 -- informace pro generov n¡ v˜raz–
        x_instance : in pexpnode;                -- v˜raz reprezentuj¡c¡ instanci
        x_tag      : in pexpnode);               -- v˜raz reprezentuj¡c¡ tag
    -- Napln¡ pole @TAG zadanou hodnotou.
    ------------------------------------------------------------------------------------------------
    static a_make_set_status (
        curr       : in tcontext;                -- kontext          
        list       : in out bllist;              -- kam se budou p©¡kazy ukl dat      
        binfo      : in blinfo;                  -- informace pro generov n¡ p©¡kaz–
        xinfo      : in expinfo;                 -- informace pro generov n¡ v˜raz–
        x_instance : in pexpnode;                -- v˜raz reprezentuj¡c¡ instanci
        x_status   : in t_class_status_field);   -- po‡ te‡n¡ hodnota pole @STATUS
    -- Napln¡ pole @STATUS zadanou po‡ te‡n¡ hodnotou. P©i©azen¡ se vygeneruje jen tehdy, kdy‘ je
    -- po‡ te‡n¡ hodnota nepr zdn .
    ------------------------------------------------------------------------------------------------
    static a_make_add_status (
        curr       : in tcontext;                -- kontext          
        list       : in out bllist;              -- kam se budou p©¡kazy ukl dat      
        binfo      : in blinfo;                  -- informace pro generov n¡ p©¡kaz–
        xinfo      : in expinfo;                 -- informace pro generov n¡ v˜raz–
        x_instance : in pexpnode;                -- v˜raz reprezentuj¡c¡ instanci
        x_status   : in t_class_status_flags);   -- nastavovan˜ p©¡znak              
    -- Dopln¡ do pole @STATUS uveden˜ p©¡znak.
    ------------------------------------------------------------------------------------------------
    static a_make_test_status (
        curr       : in tcontext;                -- kontext          
        list       : in out bllist;              -- kam se budou p©¡kazy ukl dat      
        binfo      : in blinfo;                  -- informace pro generov n¡ p©¡kaz–
        xinfo      : in expinfo;                 -- informace pro generov n¡ v˜raz–
        x_precond  : in pexpnode;                -- precondition (=precondition AND THEN status=...)
        x_instance : in pexpnode;                -- v˜raz reprezentuj¡c¡ instanci
        x_status   : in t_class_status_flags;    -- testovan˜ p©¡znak              
        b_body     : in bllist);                 -- sekvence p©¡kaz–
    -- Zjist¡, jestli je v poli @STATUS nastaven˜ uveden˜ p©¡znak, pokud ano, provede se sekvence
    -- p©¡kaz– [b_body].
    ------------------------------------------------------------------------------------------------

    end c_class_hidden_field_helper;

end ca_util;
