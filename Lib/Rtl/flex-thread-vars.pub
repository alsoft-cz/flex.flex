---------------------------------------------------------------------------------------------------
module public vars =
-- Flex Run-time Library
-- Thread variables
-- Copyright (C) 1999-2003 A && L soft
----------------------------------------------------------------------------------------------------

const
    tv_hash_size   = 101;

type
    t_threadvar_id = t_rtl_native_unsigned;

    t_tv_var;
    p_tv_var = ^t_tv_var;
    t_tv_var = record
      threadvarid  : t_threadvar_id;
      next_var     : p_tv_var;
      inheritable  : t_rtl_logical8;
      data         : t_rtl_pointer;
      end record;

    t_thread_vars = record
      hash_tv_var  : array 0..tv_hash_size-1 of p_tv_var;
      end record;
    p_thread_vars = ^t_thread_vars;


----------------------------------------------------------------------------------------------------
procedure rtl_alloc_threadvarid (
    typetag        : in t_rtl_tag;               -- tag of type
    threadvarid    : out ref t_threadvar_id;     -- handle to thread var
    inheritable    : in t_rtl_logical8:=false;
    immediate      : in t_rtl_logical8:=false);
-- allocate thread variable handle
----------------------------------------------------------------------------------------------------
procedure rtl_free_threadvarid (
    threadvarid    : in out ref t_threadvar_id);     -- handle to thread var
-- free thread variable handle
----------------------------------------------------------------------------------------------------
procedure rtl_get_threadvar (
    threadvarid    : in t_threadvar_id           -- handle to thread var
    ) return t_rtl_pointer;
-- returns pointer to threadvar
----------------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------------
procedure rtl_get_threadvar_other (
    threadvarid    : in t_threadvar_id;          -- handle to thread var
    threadhead     : in p_thread_header
    ) return t_rtl_pointer;
-- returns pointer to threadvar
----------------------------------------------------------------------------------------------------
procedure rtl_create_threadvar (
    threadvarid    : in t_threadvar_id;          -- handle to thread var
    threadhead     : in p_thread_header;
    origthreadhead : in p_thread_header:=nil
    ) return t_rtl_pointer;
-- returns pointer to threadvar
----------------------------------------------------------------------------------------------------
procedure rtl_free_threadvar (
    threadvarid    : in t_threadvar_id;          -- handle to thread var
    currthreadhead : in p_thread_header:=nil);
----------------------------------------------------------------------------------------------------
procedure rtl_set_threadvar_inheritance (
    threadvarid    : in t_threadvar_id;          -- handle to thread var
    inheritable    : in t_rtl_logical8
    );
-- sets inheritance
----------------------------------------------------------------------------------------------------
procedure rtl_initialize_all_threadvars (
    threadhead     : in p_thread_header;
    origthreadhead : in p_thread_header
    );
-- copy all inheritable & immediate threadvars
----------------------------------------------------------------------------------------------------
procedure rtl_discard_all_threadvars (
    threadhead     : in p_thread_header
    );
-- discard all threadvars
----------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------
#separate public os;
----------------------------------------------------------------------------------------------------

end vars;